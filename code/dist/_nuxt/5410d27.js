(window.webpackJsonp=window.webpackJsonp||[]).push([[6,3],{332:function(e,t,n){var content=n(339);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(91).default)("0013093d",content,!0,{sourceMap:!1})},335:function(e,t,n){"use strict";n.r(t);n(36),n(27),n(37),n(49),n(50);var o=n(20),r=n(2);n(23),n(9),n(34),n(26),n(118),n(72),n(45),n(56),n(89);function l(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var d={components:{},inject:["ss","ui","appRoutes"],data:function(){return{averageReadingSpeedInWordPerSec:1,appActions:[{title:"PrÃ©cÃ©dent",action:"prev",icon:"chevron-back-outline"},{title:"Sauvegarder",action:"bookmark",icon:"bookmark-outline"},{title:"CrÃ©er",action:"create",icon:"add-outline",is_large:!0},{title:"Partager",action:"share",icon:"arrow-redo-outline"},{title:"Suivant",action:"next",icon:"chevron-forward-outline"}],colors:["gray","blue","pink","yellow","red","black","green"],country_emojis:{fr:"ðŸ‡«ðŸ‡·",ci:"ðŸ‡¨ðŸ‡®",ao:"ðŸ‡¦ðŸ‡´"},currentPostIndex:-1,currentViewTimeInSec:0,intervalRefreshTimeInMillisec:100,isCreateFormVisible:!1,isPlaying:!0,isPlayToggleSignVisible:!1,newPost:{content:{}},newPostSentence:null,posts:[],progressInterval:null,progressValue:0,selectedColorIndex:0,selectedCountry:null,selectedInputElm:null}},created:function(){},mounted:function(){console.log("** HomePage **"),this._initApp(),document.addEventListener("keydown",this.onKeydown)},computed:{currentPostTotalViewTime:function(){var e,content=null===(e=this.posts[this.currentPostIndex])||void 0===e?void 0:e.content,t=0;return Object.keys(content).forEach((function(e){t+=content[e].split(" ").length})),t*this.averageReadingSpeedInWordPerSec},currentContext:function(){return this.isCreateFormVisible?"form":"main"},keyIndexer:function(){var e=this;return{main:{Escape:function(){return e.pause()},Space:function(){return e.togglePlay()},ArrowLeft:function(){return e.showPrev()},ArrowRight:function(){return e.showNext()}}}},selectedColor:function(){return this.colors[this.selectedColorIndex]}},methods:{_initApp:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchPosts();case 2:e.showNext();case 3:case"end":return t.stop()}}),t)})))()},clearCreateForm:function(){this.newPost={content:{},color:null}},closeCreateForm:function(){this.isCreateFormVisible=!1,this.play()},computeViewTime:function(){var e=this;this.progressValue=0,this.currentViewTimeInSec=0,clearInterval(this.progressInterval),this.progressInterval=setInterval((function(){e.isPlaying&&(e.currentViewTimeInSec+=e.intervalRefreshTimeInMillisec/1e3,e.progressValue=100*e.currentViewTimeInSec/e.currentPostTotalViewTime)}),this.intervalRefreshTimeInMillisec)},executeAction:function(e){var t=this,n={bookmark:function(e){},create:function(e){t.openCreateForm()},prev:function(e){t.showPrev()},next:function(e){t.showNext()},share:function(e){}};try{n[e]()}catch(e){console.error("xx executeAction",e)}},fetchPosts:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("fetchPosts"),console.log("fire",e.$fire),t.next=5,e.$fire.firestore.collection("posts").get();case 5:n=t.sent,e.posts=n.docs.map((function(e){return console.log("doc",e),c({id:e.id},e.data())})),console.log("posts",e.posts),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error("Error fetching posts:",t.t0);case 13:return t.abrupt("return",{posts:e.posts});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},markPostRead:function(){var e=this.posts[this.currentPostIndex];e&&(e.is_read=!0,this.posts[this.currentPostIndex]=e)},markPostUnRead:function(){var e=this.posts[this.currentPostIndex];e&&(e.is_read=!1,this.posts[this.currentPostIndex]=e)},markAllPostsUnRead:function(){var e=this.posts.map((function(p){return c(c({},p),{},{is_read:!1})}));this.posts=e},onKeydown:function(e){var t=e.code;Object.keys(this.keyIndexer[this.currentContext]).includes(t)&&(console.log("keydown",e,"k",e.code),this.keyIndexer[this.currentContext][t]())},openCreateForm:function(){this.isCreateFormVisible=!0,this.pause()},play:function(){this.isPlaying=!0},pause:function(){this.isPlaying=!1},resume:function(){this.isPlaying=!0},saveCountrySentence:function(){this.selectedCountry&&this.newPostSentence&&(this.newPost.content[this.selectedCountry]=this.newPostSentence,this.unselectCountry())},selectCountry:function(e){var t,n,o=this;this.saveCountrySentence();var r=null!==(t=null===(n=this.newPost)||void 0===n?void 0:n.content[e])&&void 0!==t?t:null;if(console.log("selectCountry",e,"v",r,!!r),r){var l;this.newPostSentence=null!==(l=this.newPost.content[e])&&void 0!==l?l:null}else{var data=c({},this.newPost);data.content[e]="",this.newPost=data,this.newPostSentence="",console.log("new keys",this.newPost.content)}this.selectedCountry=e,setTimeout((function(){var t="input_"+e;o.selectedInputElm=document.getElementById(t),o.selectedInputElm.focus()}),1e3)},showAt:function(e){this.currentPostIndex=e,this.computeViewTime()},showNext:function(){this.markPostRead(),this.currentPostIndex>=this.posts.length-1?(this.currentPostIndex=0,this.markAllPostsUnRead()):this.currentPostIndex++,this.computeViewTime()},showPrev:function(){this.markPostUnRead(),this.currentPostIndex<1||this.currentPostIndex--,this.computeViewTime()},submitPost:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.saveCountrySentence(),e.newPost.color=e.selectedColor,t.next=4,e.$fire.firestore.collection("posts").add(e.newPost);case 4:n=t.sent,e.newPost.id=n.id,e.posts.push(e.newPost),e.clearCreateForm(),e.closeCreateForm();case 9:case"end":return t.stop()}}),t)})))()},switchColor:function(){this.selectedColorIndex=Math.floor(Math.random()*this.colors.length)},togglePlay:function(){var e=this;this.isPlayToggleSignVisible=!0,this.isPlaying=!this.isPlaying,setTimeout((function(){e.isPlayToggleSignVisible=!1}),3e3)},unselectCountry:function(){this.selectedCountry=null,this.newPostSentence=null}},watch:{progressValue:function(e){e>=100&&this.showNext()}}},f=n(68),component=Object(f.a)(d,(function(){var e,t,n,o,r,l,c,d,f=this,h=f._self._c;return h("div",{staticClass:"relative bg-gray-700 h-full flex justify-center"},[h("section",{staticClass:"relative text-2xl font-semibold mx-auto h-full w-full"},[h("nav",{staticClass:"absolute p-3 flex gap-2 justify-center top-0 left-0 w-full"},f._l(f.posts,(function(e,t){return h("span",{key:t,class:["bg-gray-400","block rounded-full w-24 h-2"]},[h("span",{directives:[{name:"show",rawName:"v-show",value:f.currentPostIndex>=t||e.is_read,expression:"currentPostIndex >= k || post.is_read"}],staticClass:"transition-all duration-200 ease-out block rounded-full bg-white h-2",style:"width:"+(e.is_read?100:f.progressValue)+"%;",on:{click:function(e){return f.showAt(t)}}})])})),0),f._v(" "),h("ul",{staticClass:"absolute top-5 md:top-0 left-0 h-full w-full grid grid-cols-5"},[h("li",{staticClass:"col-span-2 cursor-pointer h-full bg-opacity-0 bg-green-400",on:{click:f.showPrev}}),f._v(" "),h("li",{staticClass:"cursor-pointer h-full bg-opacity-0 bg-red-400",on:{click:f.togglePlay}}),f._v(" "),h("li",{staticClass:"col-span-2 cursor-pointer h-full bg-opacity-0 bg-blue-400",on:{click:f.showNext}})]),f._v(" "),h("div",{class:["bg-"+(null!==(e=null===(t=f.posts[f.currentPostIndex])||void 0===t?void 0:t.color)&&void 0!==e?e:"gray")+"-600","border-"+(null!==(n=null===(o=f.posts[f.currentPostIndex])||void 0===o?void 0:o.color)&&void 0!==n?n:"gray")+"-700","h-full transition-all duration-300 ease-out"],on:{keydow:function(e){return!e.type.indexOf("key")&&f._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:f.showPrev.apply(null,arguments)},keydown:function(e){return!e.type.indexOf("key")&&f._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])||"button"in e&&2!==e.button?null:f.showNext.apply(null,arguments)}}},[f._l(f.posts,(function(e,t){return[h("article",{directives:[{name:"show",rawName:"v-show",value:f.currentPostIndex==t,expression:"currentPostIndex == k"}],key:t,class:["bg-"+e.color+"-600","border-"+e.color+"-700"," text-white border  h-full w-full rounded  p-5 flex flex-col gap-3 items-center justify-center"]},f._l(Object.keys(e.content),(function(t,s){return h("p",{key:s,staticClass:"flex gap-2 justify-center"},[f._v("\n            "+f._s(f.country_emojis[t])+" : "+f._s(e.content[t])+"\n          ")])})),0)]}))],2),f._v(" "),h("footer",{staticClass:"absolute bottom-8 md:bottom-0 left-0 w-full flex flex-col gap-3"},[h("transition",{attrs:{name:"fade"}},[h("section",{directives:[{name:"show",rawName:"v-show",value:f.isPlayToggleSignVisible,expression:"isPlayToggleSignVisible"}],staticClass:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex justify-center items-center"},[h("span",{staticClass:"text-white p-5 rounded-full flex justify-center items-center bg-white bg-opacity-20",on:{click:f.togglePlay}},[h("ion-icon",{attrs:{name:f.isPlaying?"play-outline":"pause-outline",size:"large"}})],1)])]),f._v(" "),f.appActions?h("ul",{staticClass:"w-full flex justify-center items-center gap-3 pb-5"},f._l(f.appActions,(function(e,t){return h("li",{key:t,staticClass:"hover:bg-opacity-40 rounded-full bg-white bg-opacity-20 cursor-pointer flex justify-center items-center p-2 text-white",attrs:{title:e.title},on:{click:function(t){return f.executeAction(e.action)}}},[h("ion-icon",{attrs:{name:e.icon,size:null!=e&&e.is_large?"large":"small"}})],1)})),0):f._e()],1)]),f._v(" "),h("transition",{attrs:{name:"fade-up"}},[h("section",{directives:[{name:"show",rawName:"v-show",value:f.isCreateFormVisible,expression:"isCreateFormVisible"}],staticClass:"fixed top-0 left-0 w-full h-full bg-black bg-opacity-25 p-10"},[h("form",{staticClass:"relative flex gap-2 flex-col justify-between bg-white w-full h-full rounded p-3",on:{submit:function(e){return e.preventDefault(),f.submitPost.apply(null,arguments)}}},[h("div",{staticClass:"flex justify-end mb-2"},[h("span",{staticClass:"rounded-full p-1 flex justify-center items-center bg-black text-red-500 bg-opacity-20 hover:bg-opacity-40",on:{click:f.closeCreateForm}},[h("ion-icon",{attrs:{name:"close-outline",size:"large"}})],1)]),f._v(" "),h("article",{staticClass:"rounded transition-all duration-300 ease-out h-full w-full shadow text-white flex flex-col gap-3 justify-center items-center",class:["bg-"+f.selectedColor+"-600"]},[0==Object.keys(null!==(r=null===(l=f.newPost)||void 0===l?void 0:l.content)&&void 0!==r?r:{}).length?h("div",[f._v("\n            Choisissez un emoji:\n          ")]):h("div",{staticClass:"flex flex-col gap-2 items-center"},f._l(Object.keys(null!==(c=null===(d=f.newPost)||void 0===d?void 0:d.content)&&void 0!==c?c:{}),(function(e,s){var t,n;return h("div",{key:s,staticClass:"flex gap-2 justify-start items-center"},[h("span",[f._v("\n                "+f._s(f.country_emojis[e])+" :\n              ")]),f._v(" "),h("div",[f.selectedCountry==e?h("input",{directives:[{name:"model",rawName:"v-model",value:f.newPostSentence,expression:"newPostSentence"}],staticClass:"border-0 rounded p-1 px-2 focus:ring-0 outline-none",class:["bg-"+f.selectedColor+"-700"],attrs:{id:"input_"+e,type:"text",autofocus:"autofocus",value:""},domProps:{value:f.newPostSentence},on:{keydown:function(e){return!e.type.indexOf("key")&&f._k(e.keyCode,"enter",13,e.key,"Enter")?null:f.saveCountrySentence.apply(null,arguments)},input:function(e){e.target.composing||(f.newPostSentence=e.target.value)}}}):h("span",{on:{click:function(t){return f.selectCountry(e)}}},[h("span",[f._v("\n                    "+f._s(null!==(t=null===(n=f.newPost)||void 0===n?void 0:n.content[e])&&void 0!==t?t:"")+"\n                  ")])])])])})),0)]),f._v(" "),h("div",{staticClass:"flex items-center gap-3"},[h("div",{staticClass:"flex"},[h("span",{staticClass:"border cursor-pointer flex justify-center items-center rounded-full p-1 bg-opacity-70",class:["bg-"+f.selectedColor+"-600"],on:{click:f.switchColor}},[h("span",{class:["bg-"+f.selectedColor+"-600","block rounded-full w-7 h-7"]})])]),f._v(" "),h("div",{staticClass:"flex w-full items-center gap-3 text-xl"},[h("div",{staticClass:"flex gap-3 bg-gray-100 pl-2 pt-1 w-full overflow-x-scroll rounded"},f._l(Object.keys(f.country_emojis),(function(e,t){return h("span",{key:t,staticClass:"cursor-pointer bg-gray-200 rounded px-2 flex justify-center items-center",on:{click:function(t){return f.selectCountry(e)}}},[f._v("\n                "+f._s(f.country_emojis[e])+"\n              ")])})),0),f._v(" "),h("span",{staticClass:"cursor-pointer p-1 flex justify-center items-center rounded-full bg-black bg-opacity-25"},[h("ion-icon",{attrs:{name:"add-outline"}})],1)])]),f._v(" "),h("button",{staticClass:"rounded mt-3 shadow-lg font-semibold text-white text-lg hover:bg-green-800 bg-green-500 w-full px-3 py-2",attrs:{type:"submit"}},[f._v("\n          Poster\n        ")])])])])],1)}),[],!1,null,null,null);t.default=component.exports},336:function(e,t,n){var content=n(337);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(91).default)("52932ef6",content,!0,{sourceMap:!1})},337:function(e,t,n){var o=n(90)((function(i){return i[1]}));o.push([e.i,"/*purgecss start ignore*/\n\n.slide-enter-from,.slide-leave-to{\n  opacity:0;\n  transform:translateX(100%)\n}\n\n.slide-enter-active,.slide-leave-active{\n  transition:all .3s ease-out\n}\n\n.slide-fade-up-enter-from,.slide-fade-up-leave-to{\n  opacity:0;\n  transform:translateY(40px)\n}\n\n.slide-fade-up-enter-active,.slide-fade-up-leave-active{\n  transition:opacity .9s ease-out,transform 1s ease-out\n}\n\n.slide-fade-up-delay-enter-from,.slide-fade-up-delay-leave-to{\n  opacity:0;\n  transform:translateY(40px)\n}\n\n.slide-fade-up-delay-enter-active,.slide-fade-up-delay-leave-active{\n  transition:opacity .9s ease-out .2s,transform 1s ease-out .2s\n}\n\n.slide-down-enter-from,.slide-down-leave-to{\n  opacity:0;\n  transform:translateY(-30px)\n}\n\n.slide-down-enter-active,.slide-down-leave-active{\n  transition:all .3s ease-out\n}\n\n.slide-up-enter-from,.slide-up-leave-to{\n  opacity:0;\n  transform:translateY(30px)\n}\n\n.slide-up-enter-active,.slide-up-leave-active{\n  transition:all .2s ease-out\n}\n\n.fade-in-enter-from,.fade-in-leave-to{\n  opacity:0\n}\n\n.fade-in-enter-active{\n  transition:opacity .3s ease-out\n}\n\n.fade-in-leave-active{\n  transition:opacity .2s ease-out\n}\n\n.fade-in-delay-enter-from,.fade-in-delay-leave-to{\n  opacity:0\n}\n\n.fade-in-delay-enter-active{\n  transition:opacity .3s ease-out .2s\n}\n\n.fade-in-delay-leave-active{\n  transition:opacity .2s ease-out\n}\n\n.slide-right-enter-from,.slide-right-leave-to{\n  transform:translateX(300px)\n}\n\n.slide-right-leave-to{\n  opacity:0\n}\n\n.slide-right-enter-active{\n  transition:all .4s ease-out .2s\n}\n\n.slide-right-leave-active{\n  transition:all .3s ease-in\n}\n\n/*purgecss end ignore*/",""]),o.locals={},e.exports=o},338:function(e,t,n){"use strict";n(332)},339:function(e,t,n){var o=n(90)((function(i){return i[1]}));o.push([e.i,"/*purgecss start ignore*/\n#__layout,#__nuxt,#app,#login-page,#register-page,body,html{\n  height:100vh\n}\n::-webkit-scrollbar{\n  width:5px;\n  height:5px\n}\n::-webkit-scrollbar-track{\n  border-radius:10px\n}\n::-webkit-scrollbar-thumb{\n  background:rgba(118,133,122,.4);\n  border-radius:10px\n}\n.fade-enter-active,.fade-leave-active{\n  transition:opacity .5s\n}\n.fade-enter,.fade-leave-to{\n  opacity:0\n}\nbody{\n  --background-color:#fff;\n  --text-color:#333\n}\n.dark-mode{\n  --background-color:#333;\n  --text-color:#fff\n}\n\n/*purgecss end ignore*/",""]),o.locals={},e.exports=o},353:function(e,t,n){"use strict";n.r(t);n(336);var o=n(226),r=n(224),l=n(227),c={head:function(){return{link:[{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"}]}},data:function(){return{showPreloader:!0}},provide:{ss:r.default,ui:o.default,appRoutes:l.default},created:function(){if("undefined"!=typeof window){var e=localStorage.getItem("ALLOCO225_USER");if(e){var t=JSON.parse(e);r.default.auth.user=t,r.default.auth.authenticated=!0,this.loadApp=!0}}},onMounted:function(){this.showPreloader=!1,this.setSystemPreferredTheme(),window.matchMedia("(prefers-color-scheme: dark)").addListener(this.setSystemPreferredTheme)},computed:{theme:function(){return o.default.theme},bodyClass:function(){return"dark"===this.theme?"dark-mode":""}},methods:{fetchData:function(){r.default.methods.users.fetch(),r.default.methods.place_categories.fetch(),r.default.methods.places.fetch(),r.default.methods.geojson.fetch()},setTheme:function(e){o.default.theme=e},setSystemPreferredTheme:function(e){var t=e?e.matches:window.matchMedia("(prefers-color-scheme: dark)").matches;this.setTheme(t?"dark":"light")},toggleTheme:function(){this.setTheme("light"===this.theme?"dark":"light")}},watch:{"store.auth.authenticated":function(e){e&&this.fetchData()},$route:{immediate:!0,handler:function(e,t){document.title=e.meta.title||"Alloco225"}}}},d=(n(338),n(68)),component=Object(d.a)(c,(function(){return(0,this._self._c)("HomePage",{class:this.bodyClass,attrs:{id:"app"}})}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{HomePage:n(335).default})}}]);